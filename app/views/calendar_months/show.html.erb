<p>
  <%= @calendar_month.year %>年<%= @calendar_month.month %>月
</p>

<table border='1'>
  <tr>
    <th>月</th>
    <th>火</th>
    <th>水</th>
    <th>木</th>
    <th>金</th>
    <th>土</th>
    <th>日</th>
  </tr>
  <% @calendar_month.weeks.each do |week| %>
    <tr>
      <% week.each do |calendar_day| %>
        <td <%= "style=#{get_calendar_month_table_td_style(calendar_day)}" %> >
          <% if calendar_day %>
            <%= calendar_day.day %>日

            <%= form_for calendar_day, data: { controller: "immediately-submit-form" } do |f| %>
              <%= f.label :scheduled, '予定' %>
              <%= f.text_field :scheduled, size: 3, data: { action: "blur->immediately-submit-form#submit" }, disabled: f.object.special_holiday %>
            <% end %>

            <%= form_for calendar_day, data: { controller: "immediately-submit-form" } do |f| %>
              <%= f.label :result, '実績' %>
              <%= f.text_field :result, size: 3, data: { action: "blur->immediately-submit-form#submit" }, disabled: f.object.special_holiday %>
            <% end %>

            <% if not calendar_day.worked? %>
              <%= form_for calendar_day, data: { controller: "immediately-submit-form" } do |f| %>
                <%= f.check_box :special_holiday, id: dom_id(calendar_day), data: { action: "change->immediately-submit-form#submit" } %>
                <%= f.label :special_holiday, '稼働対象外日', for: dom_id(calendar_day) %>
              <% end %>
            <% end %>

          <% end %>
        </td>
      <% end %>
    </tr>
  <% end %>
</table>

<p>
  基準時間: <%= @calendar_month.calendar.base_hours %>時間
</p>
<p>
<!-- TODO: 基準を超えていないときは赤くする. 超えているときは緑色にする -->
  予定の合計: <%= @calendar_month.scheduled_sum %>時間
</p>
<p>
  実績の合計: <%= @calendar_month.result_sum %>時間
</p>

<hr>

<p>
  実績が未入力の予定を再計算する
</p>
